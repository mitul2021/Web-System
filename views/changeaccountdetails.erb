<html lang="en">
   <head>
      <title>Change Details</title>
      <link href="<%= url('/style.css') %>" rel="stylesheet" type="text/css" />
      <script src="changeaccountdetails.js"></script> 
   </head>
    
   <body>
      <h1>Change Account Details</h1>
      <p id="changetext">What would you like to change?:</p>
       
      <!--defines form that posts to changeaccountdetails.rb controller -->
      <!-- If you are logged in then you would be accessing this page from the profilecreate view so it would not ask you for your recovery code since you have proved that you are that user -->
      <div id="change_details_container">
         
         <% case @form_number %>
         <% when 1 %> 
            <!--Here we are comming from the profile page--->
            <!--LOGGED IN-->
            <!--displaying contents of form 1-->            
            <form method="post" action="changeaccountdetails">
               
               <div id="displayemailbox">
                   
                  <p>You have chosen to change your Email.</p> 
                   
                  <label>New Email:</label><br>
                  <input type="email" name="new_email" placeholder="Enter your desired email here..."/><br><br>
                   
                  <%if !@errors.nil? && @errors.include?("new_email") %>
                      <% @errors["new_email"].each do |error| %>
                          <p class="error"><strong><%= error %></strong></p>
                      <% end %>
                  <% end %> 
                  
                   
                  <label>Confirm with your password:</label><br>
                  <input type="password" name="password" placeholder="Enter your current password here..."/><br><br>
                  
                  <%if !@errors.nil? && @errors.include?("password") %>
                      <% @errors["password"].each do |error| %>
                          <p class="error"><strong><%= error %></strong></p>
                      <% end %>
                  <% end %> 

                  <!--hidden input type to pass to the controller information, which form is passed 1/2/3/4-->
                  <input hidden name="number" value="1"/>
                  <input type="submit" value="Request Changes" class="button" name="submit_changes"/><br><br>
               
               </div>

            </form>  
         <!-- The case for if the form number is 2 -->       
         <% when 2 %>
            <!--form no 2-->
            <!-- displaying contents of form 2 -->
            <form method="post" action="changeaccountdetails"> 
                <div id="displaypasswordbox">

                   <p>You have chosen to change your Password.</p> 

                   <label>Your current password:</label><br>
                   <input type="password" name="password" placeholder="Enter your current password here..."/><br><br>
                    
                   <%if !@errors.nil? && @errors.include?("password") %>
                      <% @errors["password"].each do |error| %>
                          <p class="error"><strong><%= error %></strong></p>
                      <% end %>
                   <% end %> 
                   
                    
                   <label>New password:</label><br> 
                   <input type="password" name="new_password" placeholder="Enter your desired password here..."/><br><br>
                   
                   <% if !@errors.nil? && @errors.include?("new_password") %>
                       <% @errors["new_password"].each do |error| %>
                           <p class="error"><strong><%= error %></strong></p>
                       <% end %>
                   <% end %> 
                   
                    
                   <label>Repeat your new password:</label><br>
                   <input type="password" name="repeat_password" placeholder="Repeat your desired password here..."/><br><br>
                   
                   <% if !@errors.nil? && @errors.include?("repeat_password") %>
                       <% @errors["repeat_password"].each do |error| %>
                           <p class="error"><strong><%= error %></strong></p>
                       <% end %>
                   <% end %>                    
                    
                   <!--hidden input type to pass to the controller information, which form is passed 1/2/3/4-->
                   <input hidden name="number" value="2"/> 
                   <input type="submit" value="Request Changes" class="button" name="submit_changes"/><br><br>
                </div>


            </form>

         <!-- If you are not logged in then you would be accessing this page from the login view so it would ask you for your recovery code since you have not proved that you are that user -->
         <!-- The case for if the form number is 3 -->
         <% when 3 %>
            <!--Here we are comming from the login page--->
            <!--NOT LOGGED IN-->
            <!--displaying the contents of form 3-->
            <form method="post" action="changeaccountdetails">
               
               <div id="displayemailbox">

                  <p>You have chosen to change your Email.</p>

                  <label>New Email:</label><br>
                  <input type="email" name="new_email" placeholder="Enter your desired email here..."/><br><br>
                  
                  <%if !@errors.nil? && @errors.include?("new_email") %>
                      <% @errors["new_email"].each do |error| %>
                          <p class="error"><strong><%= error %></strong></p>
                      <% end %>
                  <% end %> 
                  
                   
                  <label>Your current password:</label><br>
                  <input type="password" name="password" placeholder="Enter your current password here..."/><br><br>
                  
                  <%if !@errors.nil? && @errors.include?("password") %>
                      <% @errors["password"].each do |error| %>
                          <p class="error"><strong><%= error %></strong></p>
                      <% end %>
                  <% end %> 
                   
                   
                  <label>Recovery Code:</label><br>
                  <input type="text" name="recovery_code" placeholder="Enter your recovery code here..."/><br><br>
                  
                  <%if !@errors.nil? && @errors.include?("recovery_code") %>
                      <% @errors["recovery_code"].each do |error| %>
                          <p class="error"><strong><%= error %></strong></p>
                      <% end %>
                  <% end %> 
                   

                  <!--hidden input type to pass to the controller information, which form is passed 1/2/3/4-->
                  <input hidden name="number" value="3"/>
                  <input type="submit" value="Request Changes" class="button" name="submit_changes"/><br><br>

               </div>  

            
            </form>
          
         <!-- The case for if the form number is 4 -->    
         <% when 4 %> 
            <!-- displaying the contents of form 4-->
            <form method="post" action="changeaccountdetails"> 
                <div id="displaypasswordbox">

                   <p>You have chosen to change your Password.</p>
                    
                   <label>Your current email:</label><br>
                   <input type="email" name="email" placeholder="Enter your current email here..."/><br><br> 
                   
                   <%if !@errors.nil? && @errors.include?("email") %>
                      <% @errors["email"].each do |error| %>
                          <p class="error"><strong><%= error %></strong></p>
                      <% end %>
                   <% end %> 
                    
                    
                   <label>New Password:</label><br>
                   <input type="password" name="new_password" placeholder="Enter your desired password here..."/><br><br>
                   
                   <%if !@errors.nil? && @errors.include?("new_password") %>
                      <% @errors["new_password"].each do |error| %>
                          <p class="error"><strong><%= error %></strong></p>
                      <% end %>
                   <% end %> 
                    
                    
                   <label>Repeat New Password:</label><br>
                   <input type="password" name="repeat_password" placeholder="Repeat your desired password here..."/><br><br>
                   
                   <%if !@errors.nil? && @errors.include?("repeat_password") %>
                      <% @errors["repeat_password"].each do |error| %>
                          <p class="error"><strong><%= error %></strong></p>
                      <% end %>
                   <% end %> 
                    
                    
                   <label>Recovery Code:</label><br>
                   <input type="text" name="recovery_code" placeholder="Enter your recovery code here..."/><br><br>
                   
                   <%if !@errors.nil? && @errors.include?("recovery_code") %>
                      <% @errors["recovery_code"].each do |error| %>
                          <p class="error"><strong><%= error %></strong></p>
                      <% end %>
                   <% end %> 
                    
                    
                   <!--hidden input type to pass to the controller information, which form is passed 1/2/3/4-->
                   <input hidden name="number" value="4"/>
                   <input type="submit" value="Request Changes" class="button" name="submit_changes"/><br><br>
                </div>
                
            </form>
          
         <% else %>
              <% if session[:loggedin] %>
                  
                  <!-- For form 1 -->
                  <a href="changeaccountdetails?form=1" class="button" >Change Email</a>
                  
                  <!-- For form 2 -->
                  <a href="changeaccountdetails?form=2" class="button" >Change Password</a>
              
              <% else %>
                  
                  <!-- For form 3 -->
                  <a href="changeaccountdetails?form=3" class="button" >Change Email</a>
                  
                  <!-- For form 4 -->
                  <a href="changeaccountdetails?form=4" class="button" >Change Password</a>
              
              <% end %>
          
         <% end %>
          
         <a href="javascript:history.back()" class="button">Go Back</a>
      
      </div>
   
   </body>

</html>